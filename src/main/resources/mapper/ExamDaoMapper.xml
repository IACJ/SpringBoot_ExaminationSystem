<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="examination.dao.ExamDao">
    <select id="findPaperById" resultType="Paper">
        SELECT * FROM `paper` WHERE `id`=#{id}
    </select>

    <select id="listPaperByClass" resultType="Map">
        SELECT * FROM `paper` WHERE `classid` LIKE '%|${classid}|%'
    </select>

    <select id="listGradeBySid" resultType="Map">
        SELECT pid,paper.name as pname,teacher.name as tname,paper.begintime,paper.finishtime,record.score
        FROM `record` INNER JOIN `paper` on paper.id=record.pid
            inner JOIN `teacher` on teacher.id=paper.tid
        WHERE sid = #{sid}
    </select>

    <insert id="submit" parameterType="examination.entity.Record" useGeneratedKeys="true" keyProperty="runid">
        INSERT INTO `record`(`sid`, `pid`, `record`, `status`, `score`)
        VALUES (#{sid},#{pid},#{record},'等待批改',0);
    </insert>

    <select id="listExamByTid" resultType="Paper">
        SELECT * FROM `paper` WHERE `tid`=#{tid}
    </select>

    <select id="listStudentGrade" resultType="Map">
        SELECT name,score
        FROM `record` INNER JOIN `student` on record.sid=student.id
        WHERE pid = #{pid}
    </select>

</mapper>
