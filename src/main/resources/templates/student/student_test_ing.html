<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
	<title>学生考试中</title>
	<link rel="stylesheet" type="text/css" href="/css/bootstrap.css"  />
	<link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css"  />
	<link rel="stylesheet" type="text/css" href="/css/bootstrap-responsive.css"  />
	<link rel="stylesheet" type="text/css" href="/css/bootstrap-responsive.min.css"  />
	<link rel="stylesheet" type="text/css" href="/css/aaa.css"  />
	<script src="http://cdn.static.runoob.com/libs/jquery/1.10.2/jquery.min.js"></script>


</head>



<body>
	<h1>学生考试中</h1>

    <br/>  <br/>  <br/>

    <div id="mainPage">
        <h1 id="examName"></h1>
        <br/>
        <form id="examForm">
        <div id="choice"></div>
        <div id="truefalse"></div>
        <div id="sub"></div>
        <br/>
        <div>    <input id="submit" type="submit" value="提交" /> </div>
        </form>
    </div>
    <br/>  <br/>  <br/>
<script>

    var F_get_choice = function(id) {
        $.get("/student/student_exercise_choice_get_question?id=" + id, function (data, status) {
            var str = '<div><h2>'+data.question+'</h2>' +
                '<input type="radio"  display="inline" name="cho_' +data.id +'" value="A" /><p>'+data.option1+'</p>' +
                '<input type="radio"  display="inline" name="cho_'+ data.id +'" value="B" /><p>'+data.option2+'</p>' +
                '<input type="radio"  display="inline" name="cho_'+ data.id +'" value="C" /><p>'+data.option3+'</p>' +
                '<input type="radio"  display="inline" name="cho_'+ data.id +'" value="D" /><p>'+data.option4+'</p></div>';
            $("#choice").append(str);
        });
    };

    var F_get_truefalse = function(id) {
        $.get("/student/student_exercise_truefalse_get_question?id=" + id, function (data, status) {
            var str = '<div><h2>' + data.question + '</h2>' +
                '<input type="radio"  display="inline" name="tf_' + data.id + '" value="T" /><p>True</p>' +
                '<input type="radio"  display="inline" name="tf_' + data.id + '" value="F" /><p>False</p></div>';
            $("#truefalse").append(str);
        });
    };

    var F_get_sub = function(id) {
        $.get("/student/student_exercise_sub_get_question?id=" + id, function (data, status) {
            var str = '<div><h2>'+data.question+'</h2>' +
                ' <textarea name="sub_' +data.id +'" style="width:400px;height:180px;">这里写内容</textarea></div>';
            $("#sub").append(str);
        });
    };

    var choiids;
    var judgids;
    var subids;
    var pid = 2;
    $(document).ready(function() {

        $.get("/student/student_test_get_paper?id=" + pid,function (data, status) {
            console.log(data);
            $('#examName').text(data.name);

            choiids = data.choi.split(',');
            judgids = data.judg.split(',');
            subids = data.sub.split(',');

            if (choiids[0] !=="" ){
                for (i in choiids){
                    F_get_choice(choiids[i]);
                }
            }


            if (judgids[0] !== ""){
                for (i in judgids){
                    F_get_truefalse(judgids[i]);
                }
            }
            if (subids[0] !=="" ) {
                for (i in subids) {
                    F_get_sub(subids[i]);
                }
            }
        });
    });

    //ajax提交form表单的方式
    $('#examForm').submit(function() {
        event.preventDefault()
        var AjaxURL= "/student/student_test_submit";
        var d = {};
        var t = $('form').serializeArray();
        $.each(t, function() {
            d[this.name] = this.value;
        });

        $.ajax({
            type: "POST",
            url: AjaxURL,
            data:  "ans="+JSON.stringify(d)+'&amp;'+"pid="+pid,
            success: function (data) {
                alert("提交成功");
            },
            error: function(data) {
                alert("提交失败！请重试！");
            }
        });
    });




</script>

</body>
</html>